{"version":3,"file":"min.js","sources":["../src/main.js"],"sourcesContent":["const exposed = {};\nif (location.search) {\n  var a = document.createElement(\"a\");\n  a.href = location.href;\n  a.search = \"\";\n  history.replaceState(null, null, a.href);\n}\n\nfunction tweet_(url) {\n  open(\n    \"https://twitter.com/intent/tweet?url=\" + encodeURIComponent(url),\n    \"_blank\"\n  );\n}\nfunction tweet(anchor) {\n  tweet_(anchor.getAttribute(\"href\"));\n}\nexpose(\"tweet\", tweet);\n\nfunction share(anchor) {\n  var url = anchor.getAttribute(\"href\");\n  event.preventDefault();\n  if (navigator.share) {\n    navigator.share({\n      url: url,\n    });\n  } else if (navigator.clipboard) {\n    navigator.clipboard.writeText(url);\n    message(\"Article URL copied to clipboard.\");\n  } else {\n    tweet_(url);\n  }\n}\nexpose(\"share\", share);\n\nfunction message(msg) {\n  var dialog = document.getElementById(\"message\");\n  dialog.textContent = msg;\n  dialog.setAttribute(\"open\", \"\");\n  setTimeout(function () {\n    dialog.removeAttribute(\"open\");\n  }, 3000);\n}\n\nfunction prefetch(e) {\n  if (e.target.tagName != \"A\") {\n    return;\n  }\n  if (e.target.origin != location.origin) {\n    return;\n  }\n  var l = document.createElement(\"link\");\n  l.rel = \"prefetch\";\n  l.href = e.target.href;\n  document.head.appendChild(l);\n}\ndocument.documentElement.addEventListener(\"mouseover\", prefetch, {\n  capture: true,\n  passive: true,\n});\ndocument.documentElement.addEventListener(\"touchstart\", prefetch, {\n  capture: true,\n  passive: true,\n});\n\nconst GA_ID = document.documentElement.getAttribute(\"ga-id\");\nwindow.ga =\n  window.ga ||\n  function () {\n    if (!GA_ID) {\n      return;\n    }\n    (ga.q = ga.q || []).push(arguments);\n  };\nga.l = +new Date();\nga(\"create\", GA_ID, \"auto\");\nga(\"set\", \"transport\", \"beacon\");\nvar timeout = setTimeout(\n  (onload = function () {\n    clearTimeout(timeout);\n    ga(\"send\", \"pageview\");\n  }),\n  1000\n);\n\nvar ref = +new Date();\nfunction ping(event) {\n  var now = +new Date();\n  if (now - ref < 1000) {\n    return;\n  }\n  ga(\"send\", {\n    hitType: \"event\",\n    eventCategory: \"page\",\n    eventAction: event.type,\n    eventLabel: Math.round((now - ref) / 1000),\n  });\n  ref = now;\n}\naddEventListener(\"pagehide\", ping);\naddEventListener(\"visibilitychange\", ping);\naddEventListener(\n  \"click\",\n  function (e) {\n    var button = e.target.closest(\"button\");\n    if (!button) {\n      return;\n    }\n    ga(\"send\", {\n      hitType: \"event\",\n      eventCategory: \"button\",\n      eventAction: button.getAttribute(\"aria-label\") || button.textContent,\n    });\n  },\n  true\n);\nvar selectionTimeout;\naddEventListener(\n  \"selectionchange\",\n  function () {\n    clearTimeout(selectionTimeout);\n    var text = String(document.getSelection()).trim();\n    if (text.split(/[\\s\\n\\r]+/).length < 3) {\n      return;\n    }\n    selectionTimeout = setTimeout(function () {\n      ga(\"send\", {\n        hitType: \"event\",\n        eventCategory: \"selection\",\n        eventAction: text,\n      });\n    }, 2000);\n  },\n  true\n);\n\nif (window.ResizeObserver && document.querySelector(\"header nav #nav\")) {\n  var progress = document.getElementById(\"reading-progress\");\n\n  var timeOfLastScroll = 0;\n  var requestedAniFrame = false;\n  function scroll() {\n    if (!requestedAniFrame) {\n      requestAnimationFrame(updateProgress);\n      requestedAniFrame = true;\n    }\n    timeOfLastScroll = Date.now();\n  }\n  addEventListener(\"scroll\", scroll);\n\n  var winHeight = 1000;\n  var bottom = 10000;\n  function updateProgress() {\n    requestedAniFrame = false;\n    var percent = Math.min(\n      (document.scrollingElement.scrollTop / (bottom - winHeight)) * 100,\n      100\n    );\n    progress.style.transform = `translate(-${100 - percent}vw, 0)`;\n    if (Date.now() - timeOfLastScroll < 3000) {\n      requestAnimationFrame(updateProgress);\n      requestedAniFrame = true;\n    }\n  }\n\n  new ResizeObserver(() => {\n    if (document.querySelector(\"#comments,footer\")){\n      bottom =\n      document.scrollingElement.scrollTop +\n      // document.querySelector(\"#comments,footer\").getBoundingClientRect().top;\n      document.querySelector(\"#comments,footer\").getBoundingClientRect().top;\n    }\n    winHeight = window.innerHeight;\n    scroll();\n  }).observe(document.body);\n}\n\nfunction expose(name, fn) {\n  exposed[name] = fn;\n}\n\naddEventListener(\"click\", (e) => {\n  const handler = e.target.closest(\"[on-click]\");\n  if (!handler) {\n    return;\n  }\n  e.preventDefault();\n  const name = handler.getAttribute(\"on-click\");\n  const fn = exposed[name];\n  if (!fn) {\n    throw new Error(\"Unknown handler\" + name);\n  }\n  fn(handler);\n});\n\n// There is a race condition here if an image loads faster than this JS file. But\n// - that is unlikely\n// - it only means potentially more costly layouts for that image.\n// - And so it isn't worth the querySelectorAll it would cost to synchronously check\n//   load state.\ndocument.body.addEventListener(\n  \"load\",\n  (e) => {\n    if (e.target.tagName != \"IMG\") {\n      return;\n    }\n    // Ensure the browser doesn't try to draw the placeholder when the real image is present.\n    e.target.style.backgroundImage = \"none\";\n  },\n  /* capture */ \"true\"\n);\n\n// scrolling toc\n// -----------------------------------------\nif (document.querySelectorAll(\"h2, h3, h4\") != null) {\n  function headingTOC() {\n    document.querySelectorAll(\"h2, h3, h4\").forEach((heading) => {\n      if (document.getElementsByTagName(\"html\")[0].scrollTop >= heading.offsetTop - 100) {\n        var id = heading.getAttribute(\"id\"); // id of headings\n        if (id != null) {\n          var toc = document.getElementsByClassName(\"toc\")[0];\n          if (toc != null) {\n            toc.querySelectorAll(\"a\").forEach((item) => {\n              item.parentElement.classList.remove(\"toc-active\");\n            });\n            document.querySelector(`.toc li a[href=\"#${id}\"]`).parentElement.classList.add('toc-active');\n          }\n        }\n      }\n    });\n  }\n  addEventListener(\"scroll\", headingTOC);\n}\n\n// anchor link fixed navigation from top\n// -----------------------------------------\nfunction offsetAnchor() {\n  if (location.hash.length !== 0) {\n    window.scrollTo({ left: window.scrollX, top: window.scrollY - 60 });\n  }\n}\n// Captures click events of all <a> elements with href starting with #\naddEventListener('click', function (e) {\n  // Click events are captured before hashchanges. Timeout\n  // causes offsetAnchor to be called after the page jump.\n  if (e.target.tagName == \"A\" && e.target.hash.startsWith(\"#\")) {\n    window.setTimeout(function () {\n      offsetAnchor();\n    }, 0);\n  }\n});\n// Set the offset when entering page with hash present in the url\nwindow.setTimeout(offsetAnchor, 0);\n\n// hide/show box\n// -----------------------------------------\nvar triggers = Array.from(document.querySelectorAll('[class=\"hs__title\"]'));\nwindow.addEventListener('click', (ev) => {\n  if (ev.target.classList.contains(\"hs__title\")) {\n    ev.target.classList.toggle(\"show\");\n  }\n}, false);\n\n\n// elasticlunr\n// -----------------------------------------\n(function (window, document) {\n  \"use strict\";\n\n  const search = (e) => {\n    const results = window.searchIndex.search(e.target.value, {\n      bool: \"OR\",\n      expand: true,\n    });\n\n    const kw = e.target.value;\n    var regEx = new RegExp(kw, \"ig\");\n\n    const divRes = document.getElementById(\"search-result\");\n    const resEl = document.getElementById(\"searchResults\");\n    const noResultsEl = document.getElementById(\"noResultsFound\");\n\n    resEl.innerHTML = \"\";\n    if (e.target.value != \"\") {\n      divRes.style.display = \"block\";\n      if (results != \"\") {\n        noResultsEl.style.display = \"none\";\n        results.map((r) => {\n          var { id, title, keywords } = r.doc;\n          const el = document.createElement(\"li\");\n          resEl.appendChild(el);\n\n          const h3 = document.createElement(\"h3\");\n          el.appendChild(h3);\n\n          const a = document.createElement(\"a\");\n          a.setAttribute(\"href\", id);\n          if (title && kw){\n            if (title.toLowerCase().includes(kw.toLowerCase())){\n              title = title.replace(regEx, function (x) {\n                return '<mark>'+x+'</mark>';\n              });\n            }\n          }\n          a.innerHTML = title;\n          h3.appendChild(a);\n\n          const p = document.createElement(\"p\");\n          if (keywords && kw){\n            if (keywords.toLowerCase().includes(kw.toLowerCase())){\n              keywords = keywords.replace(regEx, function (x) {\n                return '<mark>'+x+'</mark>';\n              });\n            }\n            if (keywords.length > 500){\n              keywords = \"...\" + keywords.substring(keywords.indexOf(\"<mark>\")-1, keywords.indexOf(\"<mark>\")+kw.length+15) + \"...\"\n            }\n          }\n          p.innerHTML = keywords;\n          el.appendChild(p);\n        });\n      } else {\n        noResultsEl.style.display = \"block\";\n      }\n    } else {\n      divRes.style.display = \"none\";\n    }\n  };\n\n  fetch(\"/pages/search-index.json\").then((response) =>\n    response.json().then((rawIndex) => {\n      window.searchIndex = elasticlunr.Index.load(rawIndex);\n      document.getElementById(\"searchField\").addEventListener(\"input\", search);\n    })\n  );\n})(window, document);"],"names":["exposed","location","search","a","document","createElement","href","history","replaceState","tweet_","url","open","encodeURIComponent","prefetch","e","target","tagName","origin","l","rel","head","appendChild","expose","anchor","getAttribute","msg","dialog","event","preventDefault","navigator","share","clipboard","writeText","getElementById","textContent","setAttribute","setTimeout","removeAttribute","documentElement","addEventListener","capture","passive","GA_ID","window","ga","q","push","arguments","Date","selectionTimeout","timeout","onload","clearTimeout","ref","ping","now","hitType","eventCategory","eventAction","type","eventLabel","Math","round","button","closest","text","String","getSelection","trim","split","length","ResizeObserver","querySelector","progress","timeOfLastScroll","requestedAniFrame","scroll","requestAnimationFrame","updateProgress","winHeight","bottom","percent","min","scrollingElement","scrollTop","style","transform","getBoundingClientRect","top","innerHeight","observe","body","name","fn","handler","Error","backgroundImage","querySelectorAll","forEach","heading","getElementsByTagName","offsetTop","id","toc","getElementsByClassName","item","parentElement","classList","remove","add","offsetAnchor","hash","scrollTo","left","scrollX","scrollY","startsWith","Array","from","ev","contains","toggle","results","searchIndex","value","bool","expand","kw","regEx","RegExp","divRes","resEl","noResultsEl","innerHTML","display","map","r","title","keywords","doc","el","h3","toLowerCase","includes","replace","x","p","substring","indexOf","fetch","then","response","json","rawIndex","elasticlunr","Index","load"],"mappings":"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"}