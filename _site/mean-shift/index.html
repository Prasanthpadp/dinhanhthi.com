<!DOCTYPE html><html domain=".com" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="default-src 'self';object-src 'none';script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com/ https://gist.github.com/;style-src 'self' https://fonts.googleapis.com/ https://use.fontawesome.com/ 'unsafe-inline' https://github.githubassets.com/;img-src 'self' data:;font-src 'self' https://fonts.gstatic.com/ https://use.fontawesome.com/" http-equiv="Content-Security-Policy"><link href="/favicon.svg" rel="icon" type="image/svg+xml"><meta content="#f9c412" name="theme-color"><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name="robots"><title>Mean Shift clustering</title><meta content="Mean Shift clustering" property="og:title"><meta content="What? # Mean-Shift assigns the data points to the clusters iteratively by shifting points towards the mode (mode is the highest density of..." name="description"><meta content="What? # Mean-Shift assigns the data points to the clusters iteratively by shifting points towards the mode (mode is the highest density of..." property="og:description"><meta content="summary_large_image" name="twitter:card"><meta content="@dinhanhthi" name="twitter:site"><meta content="@dinhanhthi" name="twitter:creator"><meta content="https://dinhanhthi.com/img/remote/ZkEGgR.png" property="og:image"><meta content="article" property="og:type"><link href="https://dinhanhthi.com/mean-shift/" rel="canonical"><meta content="https://dinhanhthi.com/mean-shift/" property="og:url"><meta content="no-referrer-when-downgrade" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="🔥 Anh-Thi DINH"><link href="/" rel="preconnect" crossorigin=""><script src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js"></script><script src="/js/min.js?hash=e09043041c" async="" defer=""></script><script csp-hash="sha256-ZO6+QmLYhAEQAnjl/xe643cTrnHA858+XwtOmaWwuN8=">if (/Mac OS X/.test(navigator.userAgent))
      document
        .documentElement
        .classList
        .add('apple')</script><style>@charset "UTF-8";@font-face{font-display:swap;font-family:"Poppins";font-style:normal;font-weight:400;src:url(/fonts/poppins/poppins-v15-latin-regular.eot);src:local("Poppins Regular"),local("Poppins-Regular"),url(/fonts/poppins/poppins-v15-latin-regular.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-regular.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-regular.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-regular.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-regular.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:"Poppins";font-style:italic;font-weight:400;src:url(/fonts/poppins/poppins-v15-latin-italic.eot);src:local("Poppins Italic"),local("Poppins-Italic"),url(/fonts/poppins/poppins-v15-latin-italic.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-italic.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-italic.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-italic.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-italic.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Poppins';font-style:normal;font-weight:600;src:url(/fonts/poppins/poppins-v15-latin-600.eot);src:local("Poppins SemiBold"),local("Poppins-SemiBold"),url(/fonts/poppins/poppins-v15-latin-600.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-600.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-600.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-600.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-600.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Poppins';font-style:italic;font-weight:600;src:url(/fonts/poppins/poppins-v15-latin-600italic.eot);src:local("Poppins SemiBold Italic"),local("Poppins-SemiBoldItalic"),url(/fonts/poppins/poppins-v15-latin-600italic.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-600italic.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-600italic.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-600italic.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-600italic.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Recoleta';src:url(/fonts/recoleta/Recoleta-Bold.woff2) format("woff2"),url(/fonts/recoleta/Recoleta-Bold.woff) format("woff"),url(/fonts/poppins/Recoleta-Bold.ttf) format("truetype");font-weight:700;font-style:bold}*{border:0;box-sizing:border-box}:root{font-size:16.5px}main img{content-visibility:auto}::-webkit-scrollbar{height:10px;width:10px}::-webkit-scrollbar-thumb{background:#3e466b;border-radius:6px}::-webkit-scrollbar-thumb:hover{background:#aaa;cursor:pointer}::-webkit-scrollbar-track{background:#363948}::-webkit-scrollbar-corner{background:#282a36}body,html{font-family:"Poppins",Arial,Helvetica,sans-serif;font-size:16.5px}html{-webkit-text-size-adjust:100%}@supports (font-variation-settings:normal){html{font-family:"Poppins" var alt,Arial,Helvetica,sans-serif}}body{background:#282a36;color:#eee;margin:0;counter-reset:h2counter}b,strong{font-weight:600;color:#8cc8ff}sup{top:-.5em}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}a,a:hover{text-decoration:none}a:hover{border-bottom:2px solid #ffd479}a.no-effect:hover{border-bottom:none}.page-note>h2:hover a:hover,a,a b,a strong{color:#ffd479}.intro a,a b:hover,a strong:hover,a:hover{color:#fff}img{max-width:100%}main{margin:0 auto}.page-note>h2,h1,h2{font-family:"Recoleta",Arial,Helvetica,sans-serif;font-size:24.75px}.page-note>h2,h1{font-size:29.7px}.page-note>h2{color:#eee;font-size:24.75px;margin:37.125px 0 19.8px}.page-note>h2:hover .direct-link{display:inline-block}.page-note .direct-link{display:none;color:#777;border-bottom:none;margin-left:3px}.page-note pre+h2{margin-top:37.125px}.page-note h1{counter-reset:h2counter}.page-note h2{counter-reset:h3counter}.page-note h2:before{content:counter(h2counter) ".  ";counter-increment:h2counter;color:#8cc8ff}.container,header{width:100%;margin:0 auto}.normal{padding:0 16.5px;width:100%}@media (min-width:916.5px){.normal{width:900px}}.mt-2{margin-top:2rem}.page-index .container{padding:2rem 1rem 0}.page-index .main-cats{flex:0 1 calc(100% - 280px);padding-right:1rem}.page-index .main-cats>.category-wrapper{padding-bottom:1.5rem}.page-index .main-cats>.category-wrapper>.category{border:1px solid #3b3e54;border-radius:7px;height:fit-content;background:#2f3240;padding:2rem 1.5rem 1.5rem}.page-index .toc-index{border:1px solid #404040;border-radius:7px;height:fit-content;background:#35373c;flex:0 1 280px;position:sticky;top:60px;padding:1rem 1.1rem}.page-index .toc-index h3{padding-bottom:5px;border-bottom:1px solid #555;margin:0 0 10px;font-size:1.3rem}.page-index .toc-index ul{padding-left:20px;margin:0}.page-index .toc-index p{font-style:italic;color:#999;padding-top:0;margin-bottom:0;font-size:.95rem;margin-top:10px}.page-index .toc-index p a{color:#999;border-bottom:2px solid #999}.page-index .toc-index p a:hover{border-bottom:2px solid #ffd479}@media (max-width:991px){.page-index .main-cats{flex:1 1 100%;order:2;padding-right:0}.page-index .toc-index{flex:1 1 100%;order:1;position:inherit;margin-bottom:1.5rem}.page-index .toc-index ul{column-count:3;-webkit-column-count:3;-moz-column-count:3}}@media (max-width:767px){.page-index .toc-index ul{column-count:2;-webkit-column-count:2;-moz-column-count:2}}@media (max-width:575px){.page-index .toc-index ul{column-count:1;-webkit-column-count:1;-moz-column-count:1}}.category{width:100%}.category h2,header h1{font-size:1.55rem;margin-top:0}.category h2 img{float:left;margin-right:7px}.category .list-homepage{list-style:none;padding-left:10px;margin-bottom:0;column-count:1;-webkit-column-count:1;-moz-column-count:1}@media (min-width:768px){.category .list-homepage{column-count:2;-webkit-column-count:2;-moz-column-count:2}}@media (min-width:992px){.category .list-homepage{column-count:3;-webkit-column-count:3;-moz-column-count:3}}.category .list-homepage li{padding-left:15px;margin-bottom:10px;display:inline-block;width:100%}.category .list-homepage li a{color:#ddd;border-bottom:2px solid rgba(255,255,255,.14);border-style:dotted}.category .list-homepage li::before{content:"📄";margin-right:5px;margin-left:-25px;opacity:.8}.category .list-homepage li:hover{cursor:pointer}.category .list-homepage li:hover a{border-color:#ffd479;color:#fff}.category .list-homepage li:hover::before{opacity:1}.page-index header{padding-top:5em;padding-bottom:0}.page-index header .header-logo{height:80px;width:auto}header nav{z-index:10}#nav{z-index:2;position:relative}header{padding:5.5rem 1.5rem 1rem;width:900px;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header h1{font-size:2.2rem;margin-bottom:0}header p{margin-top:1rem}header .header-logo{width:55px;height:55px;margin-bottom:1rem}header .header-logo img{width:100%;height:100%}header .social{margin-top:.5rem}header #more-info #note-tag>a,header .social a{margin-right:10px}header .social a:last-child{margin-right:0}@media (min-width:992px){header .social a{margin-right:20px}}header .social a img{border-radius:50%}header #more-info{padding:1rem}header #more-info #note-tag{padding-bottom:10px;border-bottom:1px solid #444}header #more-info #note-tag>a::before{content:"#"}header #more-info #last-modified{padding-top:10px;font-style:italic}#reading-progress,nav{top:0;left:0;width:100vw}#reading-progress{z-index:3;border-bottom:1px solid #ffd479;position:absolute;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}.intro,.job span{font-size:1.02rem}.intro b,.intro strong{color:#ffd479;font-weight:400}.job span{background:#ffd479;color:#000;padding:3px 10px;border-radius:15px}nav{position:fixed;padding:0 1.5em;background:#35373c}@media (max-width:992px){nav{padding:0 1em}}@media (max-width:576px){nav{padding:0 .5em}}nav #nav{display:-ms-flexbox;-ms-flex-align:center;align-items:center}nav #nav a{color:#ccc;margin-right:15px;align-items:center;padding:0 .5rem;font-size:1.1rem;white-space:nowrap}nav #nav a img{margin-right:5px}nav #nav a:hover{color:#fff;cursor:pointer;text-decoration:none}nav #nav .nav-item{text-align:left;margin-right:5px}@media (min-width:421px){nav #nav .nav-item{padding-left:0!important}}@media (max-width:575px){nav #nav .nav-item{width:unset!important}nav #nav .nav-item span{display:none}}@media (min-width:576px){nav #nav .nav-item{margin-right:15px}}nav #nav .nav-github{text-align:right;padding-right:0!important;margin-right:0!important}nav #nav .nav-github:hover img{filter:invert(.4)}nav #nav .nav-search{display:block;background-image:linear-gradient(to right,#3d4251,#3b3f4c,#393d46,#373a41,#35373c);width:100%;position:relative}nav #nav,nav #nav .nav-search form,nav #nav a{display:flex}nav #nav .nav-search .nav-search-input{border:0;background:0 0;color:#ddd;font-size:1.05rem;padding:.65rem .5rem;width:100%}nav #nav .nav-search .nav-search-input:focus{outline:0;border:0}nav #nav .nav-search #search-result{position:absolute;max-height:80vh;overflow:auto;width:100%;background:#35373c;border-bottom-right-radius:5px;border-bottom-left-radius:5px;padding:0;filter:drop-shadow(2px 4px 6px #000)}@media (max-width:767px){nav #nav .nav-search #search-result{position:fixed;left:0;right:0;border-radius:0}}nav #nav .nav-search #search-result ul#searchResults{padding:0;margin:0;list-style:none}nav #nav .nav-search #search-result ul#searchResults li{padding:10px 10px 10px 25px}nav #nav .nav-search #search-result ul#searchResults li h3{margin:0}nav #nav .nav-search #search-result ul#searchResults li h3 a{color:#efb232;white-space:inherit;padding:0;text-align:left;font-weight:400;font-size:16.5px;font-family:"Poppins",Arial,Helvetica,sans-serif;line-height:1.4}nav #nav .nav-search #search-result ul#searchResults li h3 a:hover{border-bottom:none;color:#8cc8ff}nav #nav .nav-search #search-result ul#searchResults li p{text-align:left;margin:0;line-height:1.4}nav #nav .nav-search #search-result ul#searchResults li.selected{background:#282a36}nav #nav .nav-search #search-result ul#searchResults li.selected::before{content:"⏎";float:left;color:#8cc8ff;margin-left:-20px}nav #nav .nav-search #search-result #noResultsFound{padding:0 10px}nav #nav .nav-search #search-result #noResultsFound p{text-align:left}footer{font-size:1.05rem;background:#35373c;padding:.75rem 1rem;text-align:center;margin-top:3rem}footer a{color:#ccc}footer a:hover{color:#fff}.columns-2{display:grid;grid-template-columns:1fr 1fr;align-items:center;margin-bottom:24.75px}@media (min-width:576px) and (max-width:767px){.columns-2{grid-template-columns:2fr 1fr}}@media (max-width:575px){.columns-2{grid-template-columns:1fr}}@media (min-width:576px){.columns-2>:nth-child(1){padding-right:5px;margin-bottom:0}.columns-2>:nth-child(1)>:last-child,.columns-2>:nth-child(2)>:last-child{margin-bottom:0}.columns-2>:nth-child(2){padding-left:5px;margin-bottom:0}}.hsbox{margin-bottom:24.75px;border:1px solid #969696;padding:1rem;border-radius:3px}.hsbox .hs__title{cursor:pointer}.hsbox .hs__title::before{content:" ";display:inline-block;border-top:7px solid transparent;border-bottom:7px solid transparent;border-left:7px solid currentColor;vertical-align:middle;margin-right:.7rem;transform:translateY(-2px);transition:transform .2s ease-out}.hsbox .hs__title.show{padding-bottom:15px;border-bottom:.5px solid #666;margin-bottom:1rem}.hsbox .hs__title.show+.hs__content{display:block;opacity:1;padding:5px 0;transition:all .25s 0s cubic-bezier(.4,0,.2,1)}.hsbox .hs__title.show::before{transform:rotate(90deg) translateX(-3px)}.hsbox .hs__content{display:none;transition:all .2s 0s ease}.hsbox .hs__content>:last-child{margin-bottom:0}.page-note .text-center{text-align:center}.page-note ol,.page-note p,.page-note ul{margin-top:0;margin-bottom:24.75px}.page-note p+ol,.page-note p+ul{margin-top:-.5rem}.page-note ol li,.page-note ul li,div.toc ol li{margin-bottom:5px}.page-note ol li ol,.page-note ol li ul,.page-note ul li ol,.page-note ul li ul{margin-bottom:5px;padding-left:20px}.page-note ol li>*,.page-note ul li>*{margin-bottom:10px}.page-note p.noindent{display:none;padding-left:20px}.page-note p.noindent+ol,.page-note p.noindent+ul{padding-left:20px}.page-note p.indent{display:none;padding-left:40px}.page-note ol.indent,.page-note p.indent+ol,.page-note p.indent+ul,.page-note ul.indent{padding-left:40px}.page-note ol.noindent,.page-note ul.noindent{padding-left:20px}.page-note hr{border-bottom:1px solid #676767;margin-bottom:24.75px}#reading-list .item .author{font-style:italic}#reading-list .item .intro{color:#999}code[class*=language-],pre[class*=language-]{color:#eee;font-size:16px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#75a7ca}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}.token.comment{color:#6a9955}.token.punctuation{color:#eee}.token.inserted,.token.number{color:#b5cea8}.token.operator{color:#eee}.token.keyword,.token.operator.arrow{color:#90cdff}.token.function{color:#efefac}.token.italic{font-style:italic}.token.property{color:#9cdcfe}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}code,pre{font-family:Consolas,Menlo,Monaco,"Andale Mono WT","Andale Mono","Lucida Console","Lucida Sans Typewriter","DejaVu Sans Mono","Bitstream Vera Sans Mono","Liberation Mono","Nimbus Mono L","Courier New",Courier,monospace;line-height:1.5}h2>code{font-size:21.78px!important}:not(pre)>code{border:1px solid #444;background:#6b444245;padding:2px 4px;margin:0 1px;border-radius:3px;font-size:.9rem;color:#fff;word-break:break-word}h2>code{color:#ddd;padding-right:6px}a>code{color:#ffd479}a:hover>code{color:#ccc}pre,pre[class*=language-]{margin:0 0 27.225px;overflow:auto}pre>code,pre[class*=language-]>code{display:block;padding:14.5px 16.5px 16.5px;background:#2f3240;border:.5px solid #3b3e54;overflow:auto;border-radius:3px;max-height:450px}div.toc{margin-bottom:24.75px;border:1px solid #3b3e54;border-radius:7px;height:fit-content;background:#2f3240;padding:15px 15px 10px 0}div.toc>ol::before{content:"In this note";display:block;padding-bottom:5px;border-bottom:1px solid #555;margin:0 0 15px;font-size:1.18rem;font-family:"Recoleta",Arial,Helvetica,sans-serif}div.toc ol{padding-left:20px;font-size:14.85px;margin-bottom:0}div.toc ol li code{font-size:.85rem;background:#ececec;padding:0 4px 2px}div.toc ol li ol{padding-left:10px;margin-top:7px}div.toc ol,div.toc ol ol{counter-reset:item;list-style-type:none}div.toc ol li::before{content:counters(item,".") ". ";counter-increment:item}div.toc>ol>li ol>li::before{opacity:.7}div.toc>ol>li::before{color:#8cc8ff}@media (min-width:1300px){div.toc{float:right;margin-right:-280px;border-left:none;width:250px;position:-webkit-sticky;position:sticky;top:60px;max-height:70vh;overflow:auto}div.toc ol{margin-top:0;margin-bottom:0}}@media (min-width:1500px){div.toc{margin-right:-310px;width:280px}}.toc-active>a{color:#fff!important}.toc-active::before{opacity:1!important}.page-note img{height:auto;width:100%}@media (min-width:768px){.page-note .img-full-70{width:70%;margin-left:auto;margin-right:auto;display:block}}.page-note p>img+br,.page-note p>picture+br{display:none}.page-note p>img+br+em,.page-note p>picture+br+em{display:block;text-align:center;margin-top:10px}</style></head><body><header><nav><div id="nav"><a href="/" class="nav-item no-effect"><img alt="home" height="18" src="/img/nav/home.svg" width="18"> <span>Thi</span> </a><a href="/about/" class="nav-item no-effect"><img alt="about" height="15" src="/img/nav/about.svg" width="15"> <span>About</span></a><div id="navSearch" class="nav-search"><form><input aria-label="search notes..." class="nav-search-input" id="searchField" onfocusin="inFocus(this)" placeholder="search notes..." type="search"></form><div id="search-result" style="display: none;"><ul id="searchResults"></ul><div id="noResultsFound" style="display: none;"><p>No results found.</p></div></div></div><a href="https://github.com/dinhanhthi" class="nav-item no-effect nav-github" target="_blank"><img alt="github" height="20" src="/img/nav/github.svg" width="20"></a></div><div id="reading-progress" aria-hidden="true"></div></nav><script>var divRes = document.getElementById("search-result");
var ul_rs = document.getElementById('searchResults'); // targets the <ul>

// show again if on focus
function inFocus(x) {
	if (x.value != "") {
		divRes.style.display = "block";
	}
}

// lose focus from input but don't close divRes when mouse hover on it
var isOnDiv = false;
divRes.addEventListener("mouseover", function () {
	isOnDiv = true;
});
divRes.addEventListener("mouseout", function () {
	isOnDiv = false;
});
var iput = document.getElementById("searchField");
var isTab = false;
iput.addEventListener("keydown", event => {
	if (event.keyCode === 9 || event.keyCode === 40 || event.keyCode === 38) {
		isTab = true
	} else {
		isTab = false
	};
});

// hide divRes when losing focus
/* var xx = document.getElementById("navSearch");
xx.addEventListener('focusout', function () {
	if (!isOnDiv && !isTab) {
		divRes.style.display = 'none';
	}
}); */

window.addEventListener("click", function () {
	// check if there is any result?
	var has_result = ul_rs.getElementsByTagName('li').length >= 1;
	// check if this click is inside navSearch?
	var check = document.getElementById("navSearch").contains(document.activeElement);
	if (!check || !has_result) {
		divRes.style.display = 'none';
	}
});
iput.addEventListener("click", e => {
	e.stopPropagation();
});

const addSelected = (ae) => {
	ul_rs // remove class "selected" from all li
		.querySelectorAll("li")
		.forEach((item) => {
			item
				.classList
				.remove("selected");
		});
	c_li = ae.parentNode.parentNode; // select the focused li
	c_li // add class "selected" to the focused li
		.classList
		.add("selected");
}

// arrow trigger
document.onkeydown = function (e) { // listen to keyboard events
	check = document
		.getElementById("navSearch")
		.contains(document.activeElement);

	// check if there is any result?
	has_result = ul_rs.getElementsByTagName('li').length >= 1;

	if (check && has_result) {

		if ([38, 40].indexOf(e.keyCode) > -1) { // prevent normal action of up/down
			e.preventDefault();
		}

		var firstLi = ul_rs.firstChild; // targets the first <li>
		var lastLi = ul_rs.lastChild; // last li

		switch (e.keyCode) {
			case 38: // UP
				ae = document.activeElement;
				if (ae == (iput || firstLi) || ae == firstLi.firstChild.firstChild) {
					c_li = lastLi;
				} else {
					c_li = ae.parentNode.parentNode;
					c_li = c_li.previousSibling;
				}
				c_li
					.firstChild
					.firstChild
					.focus();
				ae = document.activeElement;
				addSelected(ae);
				break;
			case 40: // DOWN
				ae = document.activeElement;
				if (ae == iput || ae == lastLi.firstChild.firstChild) {
					c_li = firstLi;
				} else {
					c_li = ae.parentNode.parentNode;
					c_li = c_li.nextSibling;
				}
				c_li
					.firstChild
					.firstChild
					.focus();
				ae = document.activeElement;
				addSelected(ae);
				break;
		}

	} // end if check
}</script><div class="header-logo"><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/header/clustering-1920w.webp 1920w, /img/header/clustering-1280w.webp 1280w, /img/header/clustering-640w.webp 640w, /img/header/clustering-320w.webp 320w" type="image/webp"><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/header/clustering-1920w.jpg 1920w, /img/header/clustering-1280w.jpg 1280w, /img/header/clustering-640w.jpg 640w, /img/header/clustering-320w.jpg 320w" type="image/jpeg"><img alt="Mean Shift clustering" height="128" src="/img/header/clustering.png" width="128" decoding="async" loading="lazy" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 128px) min(calc(var(--main-width) * 1), 128px);background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 128 128'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/klEQVQY02NgAAFxVSZzraJMS82KTZZa5ZsstYsymRX0mcByrLJqTNY6peu9jNv/B1k0/fe3aP7vbtj+HyTGpa7LxGCsmp8ZaNP9P9Jjys/u0rDfEwpjftuptv70Mmn9bwE0icFKs2STn3XX//qIWb9rXAr/hwbV/3cxbP3tZdj830anbBNYgY919/+2kKm/M/Rb/0vmbP1vHDjrt7du038b3fJNDCbqBZl+ll3/82Jm/oyMmPbbt3zd74DUJT89jdv+gxzOIKxvzGSlXbre16Lzf5BV5/8Q05b/gWZgR65jltWA+ETA0ITJFGiSpWbpJgvtsk3GGoWZrLLqYEkAyYFjQJCUOZgAAAAASUVORK5CYII='%3E%3C/image%3E%3C/svg%3E&quot;)"></picture></div><h1>Mean Shift clustering<sup>•</sup></h1><div id="more-info"><div id="note-tag"><a href="/tags/machine-learning">Machine Learning</a> <a href="/tags/clustering">Clustering</a></div><div id="last-modified">03-12-2020 / <a href="https://github.com/dinhanhthi/dinhanhthi.com/edit/dev/./posts/ml/clustering/2020-03-28-mean-shift.md">Edit on Github</a></div></div></header><main><article><div class="container mt-2 normal page-note"><div class="toc"><ol><li><a href="#what%3F">What?</a></li><li><a href="#when%3F">When?</a></li><li><a href="#pros-%26-cons">Pros &amp; Cons</a></li><li><a href="#code%3F">Code?</a></li><li><a href="#usage-example">Usage example</a></li><li><a href="#references">References</a></li></ol></div><h2 id="what%3F">What? <a href="#what%3F" class="direct-link">#</a></h2><ul><li><p>Mean-Shift assigns the data points to the clusters iteratively by shifting points towards the mode (mode is the highest density of data points in the region, in the context of the Meanshift)</p></li><li><p>Non-Parametric Density Estimation.</p></li><li><p>The data points are sampled from an underlying PDF (Probability density function)<sup><a href="http://www.cse.psu.edu/~rtc12/CSE598G/introMeanShift_6pp.pdf" target="_blank" rel="noopener noreferrer">[ref]</a></sup>.</p><p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/post/ML/clustering/mean-shift-1-1920w.webp 1920w, /img/post/ML/clustering/mean-shift-1-1280w.webp 1280w, /img/post/ML/clustering/mean-shift-1-640w.webp 640w, /img/post/ML/clustering/mean-shift-1-320w.webp 320w" type="image/webp"><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/post/ML/clustering/mean-shift-1-1920w.jpg 1920w, /img/post/ML/clustering/mean-shift-1-1280w.jpg 1280w, /img/post/ML/clustering/mean-shift-1-640w.jpg 640w, /img/post/ML/clustering/mean-shift-1-320w.jpg 320w" type="image/jpeg"><img alt="Data point density implies PDF" height="856" src="/img/post/ML/clustering/mean-shift-1.jpg" width="1840" decoding="async" loading="lazy" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 1840px) min(calc(var(--main-width) * 0.4652173913043478), 856px);background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 1840 856'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAFCAIAAAAcxIEBAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAtUlEQVQI1wGqAFX/AP7+/v33/P/+//P21+LnNOTnLu3ycP7///39+v7+/v7+/gD3+P/z78Lc6+Xl6+Lp73rb3mjU1YPm5ezf3Nvp6Oj///8Asa3aFEu8AD/GNjez7fP/0dTmkouksrK9xcXN4+Dg6ejoAPT1+H97yYeI1aux3uTq9fX6+9TY3dDZ4+Hf4Onn5+fm5gD99v7++P//+///9//+9v3////69fzq3O7v4fT68v3////2QYxyvKmmywAAAABJRU5ErkJggg=='%3E%3C/image%3E%3C/svg%3E&quot;)" class="img-full-70"></picture><br><em>Data point density implies PDF.</em></p></li><li><p>Mean-shift built based on the idea of <em>Kernel Density Estimation</em>.</p></li><li><p>Mean shift exploits this KDE idea by imagining what the points would do if they all climbed up hill to the nearest peak on the KDE surface. It does so by iteratively shifting each point uphill until it reaches a peak<sup><a href="https://spin.atomicobject.com/2015/05/26/mean-shift-clustering/" target="_blank" rel="noopener noreferrer">[ref]</a></sup>.</p><div class="columns-2" markdown="1"><p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/post/ML/clustering/mean-shift-2-1920w.webp 1920w, /img/post/ML/clustering/mean-shift-2-1280w.webp 1280w, /img/post/ML/clustering/mean-shift-2-640w.webp 640w, /img/post/ML/clustering/mean-shift-2-320w.webp 320w" type="image/webp"><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/post/ML/clustering/mean-shift-2-1920w.jpg 1920w, /img/post/ML/clustering/mean-shift-2-1280w.jpg 1280w, /img/post/ML/clustering/mean-shift-2-640w.jpg 640w, /img/post/ML/clustering/mean-shift-2-320w.jpg 320w" type="image/jpeg"><img alt="Points climb to the nearest hill." height="715" src="/img/post/ML/clustering/mean-shift-2.gif" width="1013" decoding="async" loading="lazy" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 1013px) min(calc(var(--main-width) * 0.7058242843040474), 715px);background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 1013 715'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAYAAADam2dgAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAzklEQVQY0yXPT0+DQBCHYb7/1/HQgxdtVbC2FAJF8E9RhC6LtIFdKNXL6649/DKZzJPJjKP1mXH4oe9P1KIl/6z4EJLDUaHVxDT94hRfLUXRIBv1Xz3XZT67YuUHFHlNb6ATrgM2qzVZumObvRMnCf7iFt+g/f6IsujJWxLdzXlOXwgePaKHe/wkpTKgMdvtGc7rriQKt8TpG8vFDe71jE0Q0X4PSNlfUC16aqmoygNxlhMaXJatAQohOrrOIKVOaD0xDJcvbWxvY2fjeOYPkyjl82fCkOUAAAAASUVORK5CYII='%3E%3C/image%3E%3C/svg%3E&quot;)"></picture><br><em>Points climb to the nearest hill.</em></p><p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/post/ML/clustering/mean-shift-3-1920w.webp 1920w, /img/post/ML/clustering/mean-shift-3-1280w.webp 1280w, /img/post/ML/clustering/mean-shift-3-640w.webp 640w, /img/post/ML/clustering/mean-shift-3-320w.webp 320w" type="image/webp"><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/post/ML/clustering/mean-shift-3-1920w.jpg 1920w, /img/post/ML/clustering/mean-shift-3-1280w.jpg 1280w, /img/post/ML/clustering/mean-shift-3-640w.jpg 640w, /img/post/ML/clustering/mean-shift-3-320w.jpg 320w" type="image/jpeg"><img alt="Points climb to the nearest hill." height="715" src="/img/post/ML/clustering/mean-shift-3.gif" width="1013" decoding="async" loading="lazy" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 1013px) min(calc(var(--main-width) * 0.7058242843040474), 715px);background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 1013 715'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAYAAADam2dgAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAy0lEQVQY00WPS0/CQBRG+/9/iHGBCzUiLHBhohEIpAS0NBijQjulU9qZTl/RxXGmmrg4ua+z+K5nyhZjWlRRIYQklQpld03zTVk2tO0Xnki0PZgemRqW0zk3gzOCdUgS5Sjd4IWrgOfFivggLRn+bMnd8JLtJkTKCu2kzdzn4fqKwH/haTLhcTTk8yMhLzqOR/0rxaJgF7wS7VPux7eMLs55271zOtX/UiI0WVaT2jxRnNvwqs/mBNcrZSX3gXHYD6uq6yn/ZlfruuMHf1Lnix3Y9t8AAAAASUVORK5CYII='%3E%3C/image%3E%3C/svg%3E&quot;)"></picture><br><em>Points climb to the nearest hill.</em></p></div></li></ul><h2 id="when%3F">When? <a href="#when%3F" class="direct-link">#</a></h2><ul><li>Image processing and computer vision.</li><li>Image Segmentation Application<sup><a href="https://spin.atomicobject.com/2015/05/26/mean-shift-clustering/" target="_blank" rel="noopener noreferrer">[ref]</a></sup>.</li></ul><h2 id="pros-%26-cons">Pros &amp; Cons <a href="#pros-%26-cons" class="direct-link">#</a></h2><ul><li><strong>Pros</strong>: Non-Parametric Density Estimation.</li><li><strong>Cons</strong>: It's computationally expensive O(n²) <sup><a href="https://www.geeksforgeeks.org/ml-mean-shift-clustering/" target="_blank" rel="noopener noreferrer">[ref]</a></sup>.</li></ul><h2 id="code%3F">Code? <a href="#code%3F" class="direct-link">#</a></h2><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> MeanShift<br>clustering <span class="token operator">=</span> MeanShift<span class="token punctuation">(</span>bandwidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span></code></pre><div class="flex-auto-equal-2" markdown="1"><pre class="language-python"><code class="language-python">clustering<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span><br>clustering<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span></code></pre><pre class="language-python"><code class="language-python"><span class="token comment"># or</span><br>clustering<span class="token punctuation">.</span>fit_predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span></code></pre></div><p>Components:</p><ul><li><code>clustering.labels_</code>: clusters' labels.</li></ul><h2 id="usage-example">Usage example <a href="#usage-example" class="direct-link">#</a></h2><ul><li>Used to <a href="/time-series-tips#find-the-windows-of-time-series">determined windows of time</a> in time series data.</li></ul><h2 id="references">References <a href="#references" class="direct-link">#</a></h2><ul><li><strong>Saravanan Thirumuruganathan</strong> -- <a href="https://saravananthirumuruganathan.wordpress.com/2010/04/01/introduction-to-mean-shift-algorithm/">Introduction To Mean Shift Algorithm</a>.</li><li><strong>Geeksforgeeks</strong> -- <a href="https://www.geeksforgeeks.org/ml-mean-shift-clustering/">Mean-Shift clustering</a>.</li><li><strong>R.Collins</strong> -- <a href="http://www.cse.psu.edu/~rtc12/CSE598G/introMeanShift_6pp.pdf">Mean-Shift tracking</a>.</li><li><strong>Matt Nedrich</strong> -- <a href="https://spin.atomicobject.com/2015/05/26/mean-shift-clustering/">Mean Shift Clustering</a>.</li></ul><p style="font-style: italic; color: #777; font-size: 0.95rem; margin: 3rem 0 0 0; padding-top: 10px; border-top: 1px solid #555;"><sup style="color: #bbb">•</sup>Notes with this notation aren't good enough. They are being updated.</p></div><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Mean Shift clustering","image":["https://dinhanhthi.com/img/post/ML/clustering/mean-shift-1.jpg","https://dinhanhthi.com/img/post/ML/clustering/mean-shift-2.gif","https://dinhanhthi.com/img/post/ML/clustering/mean-shift-3.gif"],"author":"Anh-Thi DINH","genre":"Insert a schema.org genre","url":"https://dinhanhthi.com/mean-shift/","mainEntityOfPage":"https://dinhanhthi.com/mean-shift/","datePublished":"27-03-2020","dateModified":"03-12-2020","description":"What? # Mean-Shift assigns the data points to the clusters iteratively by shifting points towards the mode (mode is the highest density of..."}</script></article></main><footer><a href="/" target="_blank">Thi &nbsp;©&nbsp; 2020 </a>&nbsp;•&nbsp; <a href="/about-the-notes/">About the notes </a>&nbsp;•&nbsp; <a href="https://pobo.dinhanhthi.com" target="_blank">Po Bo </a>&nbsp;•&nbsp; <a href="/for-me-only/">For me only </a>&nbsp;•&nbsp; <a href="/donate/">Support Thi</a></footer></body></html>