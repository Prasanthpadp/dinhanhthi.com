---
layout: post
title: "Pytest"
icon-photo: pytest.png
categories: [python]
keywords: "test result verify check algorithms error ImportError: No module named atomicwrites"
---

{% assign img-url = '/img/post/python' %}

{% include toc.html %}

## Install

~~~ bash
pip install pytest
~~~

## Rules

- Name all **testing files** with{% ref https://docs.pytest.org/en/latest/goodpractices.html#test-discovery %} `test_*.py` or `*_test.py`.
- Name all "be tested" functions with `def test_*`.

## Executing

~~~ bash
pytest test_sample.py
pytest -q test_sample.py # quiet mode
~~~

## Simple

~~~ python
# test_sample.py
def func(x):
    return x + 1

def test_answer():
    assert func(3) == 5
~~~

Then run `pytest test_sample.py`.

## With parameters

~~~ python
# test_sample.py
@pytest.mark.parametrize(
    "input, param_1, param_2, result",
    [
        (df_1, 'date', np.mean, df_result_1),
        (df_2, 'date', np.mean, df_result_2),
    ]
)

def test_run(input, param_1, param_2, result):
    spts = SampleTimeSeries(param_1=param_1, param_2=param_2)
    df_tmp = spts.run(df)
    assert isinstance(df_tmp, pd.DataFrame)
    assert df_tmp.equals(result)
~~~

## Errors

~~~ bash
# ImportError: No module named atomicwrites
python -m pytest
python3 -m pytest
~~~

## References

- pytest [official docs](https://docs.pytest.org/en/latest/contents.html).